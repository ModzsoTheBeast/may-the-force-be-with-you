<app-page-shell>
  <div class="character-edit-content">
    <div
      class="d-flex align-items-center justify-content-between align-items-center mb-4"
    >
      <button
        class="character-edit__header__back-button btn d-flex align-items-center gap-2"
        (click)="back()"
      >
        <img
          class="character-edit__header__back-button__icon"
          src="/assets/ui/chevron.png"
          alt="back-button"
        />
        <span class="character-edit__header__back-button__text">
          Karakterek szerkesztése
        </span>
      </button>
      <app-dynamic-button
        [text]="'Új karakter hozzáadása'"
        [variant]="'outline'"
        (onClick)="addCharacter()"
      ></app-dynamic-button>
    </div>

    <div class="table-responsive">
      <table class="table table-sm table-dark table-hover">
        <thead>
          <tr>
            <th
              scope="col"
              (click)="sort('name')"
              [attr.aria-sort]="getSortDirection('name')"
            >
              <span class="th-cell">
                <span> NÉV </span>
                @if (isSortedColumn('name')) {
                <span class="sort-indicator">
                  {{ sortDirection() === "asc" ? "▲" : "▼" }}
                </span>
                }
              </span>
            </th>
            <th
              scope="col"
              (click)="sort('side')"
              [attr.aria-sort]="getSortDirection('side')"
            >
              <span class="th-cell">
                <span> OLDAL </span>
                @if (isSortedColumn('side')) {
                <span class="sort-indicator">
                  {{ sortDirection() === "asc" ? "▲" : "▼" }}
                </span>
                }
              </span>
            </th>
            <th
              scope="col"
              (click)="sort('power')"
              [attr.aria-sort]="getSortDirection('power')"
            >
              <span class="th-cell">
                <span> KÜLÖNLEGES ERŐ </span>
                @if (isSortedColumn('power')) {
                <span class="sort-indicator" *ngIf="isSortedColumn('power')">
                  {{ sortDirection() === "asc" ? "▲" : "▼" }}
                </span>
                }
              </span>
            </th>
            <th
              scope="col"
              (click)="sort('midichlorian')"
              [attr.aria-sort]="getSortDirection('midichlorian')"
            >
              <span class="th-cell">
                <span> MIDIKLORIÁN </span>
                @if (isSortedColumn('midichlorian')) {
                <span class="sort-indicator">
                  {{ sortDirection() === "asc" ? "▲" : "▼" }}
                </span>
                }
              </span>
            </th>
            <th scope="col"></th>
          </tr>
        </thead>
        <tbody>
          @for (character of characters(); track character.uuid) {
          <tr>
            <td>{{ character.name }}</td>
            <td>{{ character.side === "DARK" ? "Sötét" : "Világos" }}</td>
            <td>{{ character.abilities.power }}</td>
            <td>{{ character.abilities.midichlorian }}</td>
            <td class="actions">
              <div class="button-wrapper">
                <button
                  class="btn button--copy"
                  (click)="copyCharacter(character)"
                >
                  Másolás
                </button>
                <button
                  class="btn button--edit"
                  data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight"
                  (click)="editCharacter(character)"
                >
                  Módosítás
                </button>
                <button
                  class="btn button--delete"
                  (click)="deleteCharacter(character)"
                >
                  Törlés
                </button>
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>

  @if (sidenav()) {
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">

      <app-character-sidebar
        [character]="selectedCharacter()"
      ></app-character-sidebar>
    </div>
  }
</app-page-shell>
